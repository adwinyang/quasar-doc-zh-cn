"use strict";(globalThis["webpackChunkquasar_dev"]=globalThis["webpackChunkquasar_dev"]||[]).push([[19333],{19333:(n,s,t)=>{t.r(s),t.d(s,{default:()=>V});var e=t(83673);const a=(0,e._)("p",null,[(0,e._)("code",{class:"doc-token"},"ssrContext"),(0,e.Uk)("对象是SSR上下文，所有应用程序的Vue组件都是用它来渲染的。")],-1),o=(0,e._)("div",{class:"doc-note doc-note--warning"},[(0,e._)("p",{class:"doc-note__title"},"WARNING"),(0,e._)("p",null,[(0,e._)("code",{class:"doc-token"},"ssrContext"),(0,e.Uk)("对象只在SSR构建中可用，在服务器端编译(当"),(0,e._)("code",{class:"doc-token"},"process.env.SERVER == true"),(0,e.Uk)(")。")])],-1),c=(0,e.Uk)("在其他地方，它作为参数提供给"),k=(0,e.Uk)("boot files"),p=(0,e.Uk)(" 、"),l=(0,e.Uk)("Vuex store"),u=(0,e.Uk)(" 和"),_=(0,e.Uk)("Vue Router"),r=(0,e.Uk)(" 初始化函数，以及"),d=(0,e.Uk)("preFetch"),i=(0,e.Uk)(" 方法。"),U=(0,e._)("pre",{class:"doc-code language-js"},[(0,e._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-js"},[(0,e._)("span",{class:"token comment"},"// 一个启动文件"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"export"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"default"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"..."),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" ssrContext "),(0,e._)("span",{class:"token punctuation"},"}")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"/* ... */"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token comment"},"// src/router/index.[js|ts]"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"export"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"default"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"..."),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" ssrContext "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"/* ... */"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token comment"},"// src/store/index.[js|ts]"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"export"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"default"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"..."),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" ssrContext "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"/* ... */"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token comment"},"// 与preFetch。"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token function"},"preFetch"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"..."),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" ssrContext "),(0,e._)("span",{class:"token punctuation"},"}")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"/* ... */"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])],-1),m=(0,e._)("p",null,"你也可以在你的Vue组件中访问ssrContext。下面是两个示例，一个用组合式 API，一个用选项式 API：",-1),g=(0,e._)("pre",{class:"doc-code language-js"},[(0,e._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-js"},[(0,e._)("span",{class:"token comment"},"// 组成API"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"import"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(" useSSRContext "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"from"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'vue'"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token keyword"},"export"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"default"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token comment"},"// ..."),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token function"},"setup"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"// 我们需要保护它，并且只在SSR服务器端调用它。"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" ssrContext "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" process"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("env"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token constant"},"SERVER"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"?"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"useSSRContext"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"null"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"// ...用它做一些事情"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])],-1),x=(0,e._)("pre",{class:"doc-code language-js"},[(0,e._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-js"},[(0,e._)("span",{class:"token comment"},"// 选项式 API"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"export"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"default"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token comment"},"// ..."),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token function"},"created"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// can be any other Vue component lifecycle hook"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("ssrContext\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])],-1),f=(0,e._)("pre",{class:"doc-code language-js"},[(0,e._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-js"},[(0,e._)("span",{class:"token literal-property property"},"ssrContext"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  req"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("        "),(0,e._)("span",{class:"token comment"},"// Express.js object"),(0,e.Uk)("\n  res"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("        "),(0,e._)("span",{class:"token comment"},"// Express.js object"),(0,e.Uk)("\n  $q"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("         "),(0,e._)("span",{class:"token comment"},"// The Quasar's $q Object"),(0,e.Uk)("\n  state"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("      "),(0,e._)("span",{class:"token comment"},"// The Vuex state (ONLY if using the Vuex store)"),(0,e.Uk)("\n\n  nonce"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("      "),(0,e._)("span",{class:"token comment"},"// (optional to set it yourself)"),(0,e.Uk)("\n              "),(0,e._)("span",{class:"token comment"},'// 要使用的全局 "nonce "属性'),(0,e.Uk)("\n\n  onRendered"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// Registers a function to be executed server-side after"),(0,e.Uk)("\n              "),(0,e._)("span",{class:"token comment"},"// 应用程序已经用Vue渲染。你可能需要这个"),(0,e.Uk)("\n              "),(0,e._)("span",{class:"token comment"},"// 在ssrContext被完全处理后再次访问它。"),(0,e.Uk)("\n              "),(0,e._)("span",{class:"token comment"},"// 示例: ssrContext.onRendered(() => { /* ... */ })"),(0,e.Uk)("\n\n  rendered    "),(0,e._)("span",{class:"token comment"},"// (optional to set it yourself)"),(0,e.Uk)("\n              "),(0,e._)("span",{class:"token comment"},"// 将此设置为一个将在服务器端执行的函数"),(0,e.Uk)("\n              "),(0,e._)("span",{class:"token comment"},"// 在应用程序用Vue渲染之后。"),(0,e.Uk)("\n              "),(0,e._)("span",{class:"token comment"},'// 我们建议使用 "onRendered "来代替。'),(0,e.Uk)("\n              "),(0,e._)("span",{class:"token comment"},"//"),(0,e.Uk)("\n              "),(0,e._)("span",{class:"token comment"},"// 目的：向后兼容Vue生态系统的软件包"),(0,e.Uk)("\n              "),(0,e._)("span",{class:"token comment"},"// (如@vue/apollo-ssr)"),(0,e.Uk)("\n              "),(0,e._)("span",{class:"token comment"},"// 示例：ssrContext.rendered = () => { /* ...。*/ }"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])],-1),w=(0,e.Uk)('关于 "nonce "属性的目的的更多信息可以在'),y=(0,e.Uk)("MDN"),h=(0,e.Uk)("上找到。"),C=(0,e._)("p",null,[(0,e._)("code",{class:"doc-token"},"req"),(0,e.Uk)("和"),(0,e._)("code",{class:"doc-token"},"res"),(0,e.Uk)("是Express.js对当前服务器客户端的对象。"),(0,e._)("code",{class:"doc-token"},"req"),(0,e.Uk)("的一个用例是访问"),(0,e._)("code",{class:"doc-token"},"req.url"),(0,e.Uk)("以获得客户端正在请求的URL。")],-1),S=(0,e._)("div",{class:"doc-note doc-note--tip"},[(0,e._)("p",{class:"doc-note__title"},"TIP"),(0,e._)("p",null,[(0,e.Uk)("你也可以将自己的东西注入到ssrContext中，但不要篡改任何私有属性(以下划线开头的属性，例如"),(0,e._)("code",{class:"doc-token"},"_someProp"),(0,e.Uk)(")。")])],-1);function R(n,s,t,R,v,j){const b=(0,e.up)("doc-link"),q=(0,e.up)("doc-page");return(0,e.wg)(),(0,e.j4)(q,{"meta-title":R.metaTitle,title:"ssrContext对象",nav:R.nav,toc:R.toc,"meta-desc":R.metaDesc},{default:(0,e.w5)((()=>[a,(0,e._)("h2",{id:"用法",class:"doc-heading doc-h2",onClick:s[0]||(s[0]=n=>R.copyHeading("用法"))},"用法"),o,(0,e._)("p",null,[c,(0,e.Wm)(b,{to:"/quasar-cli/boot-files"},{default:(0,e.w5)((()=>[k])),_:1}),p,(0,e.Wm)(b,{to:"/quasar-cli/vuex-store"},{default:(0,e.w5)((()=>[l])),_:1}),u,(0,e.Wm)(b,{to:"/quasar-cli/routing"},{default:(0,e.w5)((()=>[_])),_:1}),r,(0,e.Wm)(b,{to:"/quasar-cli/refetch-feature"},{default:(0,e.w5)((()=>[d])),_:1}),i]),U,m,g,x,(0,e._)("h2",{id:"对ssrcontext的剖析",class:"doc-heading doc-h2",onClick:s[1]||(s[1]=n=>R.copyHeading("对ssrcontext的剖析"))},"对ssrContext的剖析"),f,(0,e._)("p",null,[w,(0,e.Wm)(b,{to:"https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/nonce"},{default:(0,e.w5)((()=>[y])),_:1}),h]),C,S])),_:1},8,["meta-title","nav","toc","meta-desc"])}var v=t(17536);const j={name:"DocMarkdownPage",setup(){return{metaTitle:"ssrContext对象",metaDesc:"Quasar SSR中的ssrContext对象",nav:[{name:"配置SSR",category:"开发 SSR",path:"/quasar-cli/developing-ssr/configuring-ssr",dir:"left"},{name:"SSR 中间件",category:"开发 SSR",path:"/quasar-cli/developing-ssr/ssr-middleware",dir:"right"}],toc:[{id:"用法",title:"用法"},{id:"对ssrcontext的剖析",title:"对ssrContext的剖析"}],copyHeading:v.Et}}};var b=t(74260);const q=(0,b.Z)(j,[["render",R]]),V=q}}]);