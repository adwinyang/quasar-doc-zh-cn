"use strict";(globalThis["webpackChunkquasar_dev"]=globalThis["webpackChunkquasar_dev"]||[]).push([[13198],{13198:(s,e,a)=>{a.r(e),a.d(e,{default:()=>Y});var n=a(83673);const o=(0,n._)("p",null,"本页仅指将Quasar UI v1(使用Vue 2)的应用程序升级为Quasar UI v2(使用Vue 3)。",-1),r=(0,n._)("p",null,"Quasar v2的SSR模式几乎完全颠覆了之前的版本，大大改善了开发者的体验。由于Vue 3的架构要求，其中一些变化是必须的。",-1),c=(0,n.Uk)("请注意，目前唯一支持Nodejs的服务器是"),l=(0,n.Uk)("Expressjs"),t=(0,n.Uk)(" 。"),d=(0,n.Uk)("引入了"),i=(0,n.Uk)("SSR中间件"),u=(0,n.Uk)(" 文件的概念，这也允许在开发时为它们提供HMR。这取代了旧的"),k=(0,n._)("code",{class:"doc-token"},"index.js",-1),p=(0,n.Uk)("和"),_=(0,n._)("code",{class:"doc-token"},"extension.js",-1),m=(0,n.Uk)("。"),U=(0,n._)("li",null,"完全相同的中间件现在可以在开发和生产构建中运行，而不仅仅是旧的 “SSR扩展”。",-1),g=(0,n._)("li",null,"你也可以为SSR中间件启用提示功能。",-1),S=(0,n.Uk)("由于Vue 3的架构，你现在可以(而且需要！)为你的每个自定义Vue指令定义一个SSR转换( Quasar 提供的Vue指令不在此范围内)。 "),v=(0,n._)("strong",null,"对Typescript的开箱支持",-1),h=(0,n.Uk)("。"),q=(0,n._)("code",{class:"doc-token"},"src-ssr",-1),w=(0,n.Uk)("下的所有js文件现在可以改写成.ts。请务必阅读 "),R=(0,n.Uk)("SSR with Typescript"),f=(0,n.Uk)(" 以了解更多信息。"),j=(0,n._)("pre",{class:"doc-code language-bash"},[(0,n._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-bash"},[(0,n._)("span",{class:"token comment"},"# old structure"),(0,n.Uk)("\n"),(0,n._)("span",{class:"token builtin class-name"},"."),(0,n.Uk)("\n└── src-ssr/\n    ├── index.js      "),(0,n._)("span",{class:"token comment"},"# Production Node webserver serving the app"),(0,n.Uk)("\n    └── extension.js  "),(0,n._)("span",{class:"token comment"},"# Common code for production & development server"),(0,n.Uk)("\n\n"),(0,n._)("span",{class:"token comment"},"# NEW structure"),(0,n.Uk)("\n"),(0,n._)("span",{class:"token builtin class-name"},"."),(0,n.Uk)("\n└── src-ssr/\n    ├── middlewares/  "),(0,n._)("span",{class:"token comment"},"# SSR middleware files"),(0,n.Uk)("\n    ├── directives/   "),(0,n._)("span",{class:"token comment"},"# SSR transformations for Vue directives"),(0,n.Uk)("\n    └── production-export.js "),(0,n._)("span",{class:"token comment"},"# SSR webserver production export"),(0,n.Uk)("\n")])],-1),x=(0,n.Uk)("旧的"),y=(0,n._)("code",{class:"doc-token"},"index.js",-1),b=(0,n.Uk)("和"),C=(0,n._)("code",{class:"doc-token"},"extension.js",-1),Q=(0,n.Uk)("已经被优秀的SSR中间件文件所取代。在进一步深入研究之前，最好是"),W=(0,n.Uk)("阅读一下SSR中间件"),H=(0,n.Uk)(" 。"),V=(0,n._)("p",null,"那么我们开始吧。",-1),T=(0,n._)("ol",null,[(0,n._)("li",null,[(0,n.Uk)("我们建议你把你当前的"),(0,n._)("code",{class:"doc-token"},"src-ssr"),(0,n.Uk)("文件夹的内容保存在其他地方。")]),(0,n._)("li",null,[(0,n.Uk)("删除并重新添加Quasar SSR模式("),(0,n._)("code",{class:"doc-token"},"$ quasar mode remove ssr"),(0,n.Uk)(", "),(0,n._)("code",{class:"doc-token"},"$quasar mode add ssr"),(0,n.Uk)(")。")]),(0,n._)("li",null,"在quasar.conf.js > ssr > middlewares下声明中间件文件。[]. 数组应该看起来像这样。")],-1),E=(0,n._)("pre",{class:"doc-code language-js"},[(0,n._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-js"},[(0,n.Uk)("middlewares。"),(0,n._)("span",{class:"token punctuation"},"["),(0,n.Uk)("\nctx"),(0,n._)("span",{class:"token punctuation"},"."),(0,n.Uk)("prod "),(0,n._)("span",{class:"token operator"},"?"),(0,n.Uk)(),(0,n._)("span",{class:"token string"},"'压缩'"),(0,n.Uk)(),(0,n._)("span",{class:"token operator"},":"),(0,n.Uk)(),(0,n._)("span",{class:"token string"},"''"),(0,n.Uk)("。\n"),(0,n._)("span",{class:"token string"},"'render'"),(0,n.Uk)(),(0,n._)("span",{class:"token comment"},"// 应该始终把这个作为最后一个。"),(0,n.Uk)("\n"),(0,n._)("span",{class:"token punctuation"},"]"),(0,n.Uk)("\n")])],-1),D=(0,n._)("ol",{start:"4"},[(0,n._)("li",null,"然后你将不得不通过使用SSR中间件文件来移植旧的逻辑，这应该非常容易(因为你最终会把大部分旧的代码复制到中间件文件中)。"),(0,n._)("li",null,"查看quasar.conf.js > ssr属性。大多数旧属性已经被删除，并被[新属性]取代(/quasar-cli/developing-ssr/configuring-ssr#quasar-conf-js)。")],-1),N=(0,n._)("p",null,[(0,n.Uk)("还要记住，你在"),(0,n._)("code",{class:"doc-token"},"src-ssr/middlewares"),(0,n.Uk)("文件夹中创建的文件也需要在quasar.conf.js > ssr > middlewares下声明。这是因为它们的顺序很重要，就像应用任何Expressjs中间件的顺序也很重要。你可以使用"),(0,n._)("code",{class:"doc-token"},"$ quasar new ssrmiddleware <name>"),(0,n.Uk)("命令来加快进度。")],-1),P=(0,n._)("p",null,[(0,n.Uk)("始终保持原始的"),(0,n._)("code",{class:"doc-token"},"render"),(0,n.Uk)("中间件在列表的最后一个。")],-1),$=(0,n.Uk)("你可能想看看"),I=(0,n.Uk)("新配置"),M=(0,n.Uk)(" 的属性，可通过quasar.conf.js > ssr获得。"),Z=(0,n.Uk)("你可能想看看"),z=(0,n.Uk)("ssrContext"),A=(0,n.Uk)(" 页面，它详细描述了你可以从中使用哪些属性。"),B=(0,n.Uk)("你可能想看看 "),F=(0,n.Uk)("SSR Production Export"),G=(0,n.Uk)(" 页面，它详细描述了production-export.js/ts可以为你做什么。");function J(s,e,a,J,K,L){const O=(0,n.up)("doc-link"),X=(0,n.up)("doc-page");return(0,n.wg)(),(0,n.j4)(X,{"meta-title":J.metaTitle,title:"SSR的升级指南",related:J.related,nav:J.nav,toc:J.toc,"meta-desc":J.metaDesc},{default:(0,n.w5)((()=>[o,(0,n._)("h2",{id:"从quasar-v1升级到quasar-v2",class:"doc-heading doc-h2",onClick:e[0]||(e[0]=s=>J.copyHeading("从quasar-v1升级到quasar-v2"))},"从Quasar v1升级到Quasar v2"),r,(0,n._)("p",null,[c,(0,n.Wm)(O,{to:"https://expressjs.com/"},{default:(0,n.w5)((()=>[l])),_:1}),t]),(0,n._)("h3",{id:"改进的高度概述",class:"doc-heading doc-h3",onClick:e[1]||(e[1]=s=>J.copyHeading("改进的高度概述"))},"改进的高度概述"),(0,n._)("ul",null,[(0,n._)("li",null,[d,(0,n.Wm)(O,{to:"/quasar-cli/developing-ssr/ssr-middleware"},{default:(0,n.w5)((()=>[i])),_:1}),u,k,p,_,m]),U,g,(0,n._)("li",null,[S,v,h,q,w,(0,n.Wm)(O,{to:"/quasar-cli/developing-ssr/ssr-with-typescript"},{default:(0,n.w5)((()=>[R])),_:1}),f])]),(0,n._)("h3",{id:"-src-ssr文件夹",class:"doc-heading doc-h3",onClick:e[2]||(e[2]=s=>J.copyHeading("-src-ssr文件夹"))},"/src-ssr文件夹"),j,(0,n._)("h3",{id:"执行升级",class:"doc-heading doc-h3",onClick:e[3]||(e[3]=s=>J.copyHeading("执行升级"))},"执行升级"),(0,n._)("p",null,[x,y,b,C,Q,(0,n.Wm)(O,{to:"/quasar-cli/developing-ssr/ssr-middleware"},{default:(0,n.w5)((()=>[W])),_:1}),H]),V,T,E,D,N,P,(0,n._)("h3",{id:"提示",class:"doc-heading doc-h3",onClick:e[4]||(e[4]=s=>J.copyHeading("提示"))},"提示"),(0,n._)("ul",null,[(0,n._)("li",null,[$,(0,n.Wm)(O,{to:"/quasar-cli/developing-ssr/configuring-ssr"},{default:(0,n.w5)((()=>[I])),_:1}),M]),(0,n._)("li",null,[Z,(0,n.Wm)(O,{to:"/quasar-cli/developing-ssr/ssr-context"},{default:(0,n.w5)((()=>[z])),_:1}),A]),(0,n._)("li",null,[B,(0,n.Wm)(O,{to:"/quasar-cli/developing-ssr/ssr-production-export"},{default:(0,n.w5)((()=>[F])),_:1}),G])])])),_:1},8,["meta-title","related","nav","toc","meta-desc"])}var K=a(17536);const L={name:"DocMarkdownPage",setup(){return{metaTitle:"SSR的升级指南",metaDesc:"处理SSR时从Quasar v1升级到v2的说明。",related:[{name:"配置SSR",category:"开发 SSR",path:"/quasar-cli/developing-ssr/configuring-ssr"},{name:"ssrContext",category:"开发 SSR",path:"/quasar-cli/developing-ssr/ssr-context"},{name:"SSR 中间件",category:"开发 SSR",path:"/quasar-cli/developing-ssr/ssr-middleware"},{name:"SSR 生产导出",category:"开发 SSR",path:"/quasar-cli/developing-ssr/ssr-production-export"}],nav:[{name:"编写通用代码",category:"开发 SSR",path:"/quasar-cli/developing-ssr/writing-universal-code",dir:"left"},{name:"准备工作",category:"开发 SSR",path:"/quasar-cli/developing-ssr/preparation",dir:"right"}],toc:[{id:"从quasar-v1升级到quasar-v2",title:"从Quasar v1升级到Quasar v2"},{id:"改进的高度概述",title:"改进的高度概述",sub:!0},{id:"-src-ssr文件夹",title:"/src-ssr文件夹",sub:!0},{id:"执行升级",title:"执行升级",sub:!0},{id:"提示",title:"提示",sub:!0}],copyHeading:K.Et}}};var O=a(74260);const X=(0,O.Z)(L,[["render",J]]),Y=X}}]);