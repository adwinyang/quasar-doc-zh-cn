"use strict";(globalThis["webpackChunkquasar_dev"]=globalThis["webpackChunkquasar_dev"]||[]).push([[28353],{28353:(n,a,s)=>{s.r(a),s.d(a,{default:()=>F});var t=s(83673);const o=(0,t._)("p",null,"了解你的用户和衡量用户行为是App开发的一个重要步骤。不幸的是，在用Capacitor包装你的移动应用程序后，要让Google Analytics发挥作用，需要做一些非标准的工作。在纯网络应用程序中设置Google Analytics是相当容易的，但Capacitor不知为何会阻止页面浏览和事件被发送到Google Analytics。",-1),e=(0,t._)("p",null,"按照这个指南，在你的Capacitor驱动的Quasar App中实施Google Analytics。",-1),c=(0,t.Uk)("你也可以阅读这个伟大的教程。"),p=(0,t.Uk)("为SPA网站设置 Google 标签管理器和分析"),l=(0,t._)("div",{class:"doc-note doc-note--warning"},[(0,t._)("p",{class:"doc-note__title"},"WARNING"),(0,t._)("p",null,[(0,t.Uk)("你需要在"),(0,t._)("code",{class:"doc-token"},"/src/index.template.html"),(0,t.Uk)("中加入 Google 提供的"),(0,t._)("code",{class:"doc-token"},"<script>"),(0,t.Uk)('标签，这将使你的应用程序依赖于互联网连接！"。')])],-1),k=(0,t.Uk)("确保你所有的路由都有一个指定的名称和路径参数。否则，它们不能被发布到"),u=(0,t._)("code",{class:"doc-token"},"ga.logPage",-1),i=(0,t.Uk)("函数中。请参考"),r=(0,t.Uk)("Routing"),_=(0,t.Uk)("了解更多关于路由的信息。 *具备 Google 分析的基本知识"),d=(0,t.Uk)("在我们开始在你的应用程序中实施Google Analytics之前，你需要一个"),U=(0,t.Uk)("Google Analytics"),g=(0,t.Uk)("和"),y=(0,t.Uk)("Google Tagmanager"),m=(0,t.Uk)("的账户。所以让我们先做这个。当你有了这些账户，是时候配置Tag manager了。按照这个"),w=(0,t.Uk)("Multiminds文章"),h=(0,t.Uk)("中的步骤来做。"),f={class:"doc-note"},v=(0,t.Uk)("在本指南中，我们将假设你有一个固定的sessionId，并将其发送给Google Analytics。Google Analytics使用sessionId来区分不同的用户。如果你想创建一个匿名的sessionId，请参阅"),b=(0,t.Uk)("关于用户 ID 的分析文档"),G=(0,t.Uk)(" 。"),j=(0,t.Uk)("将Tag Manager片段放到你的"),A=(0,t._)("code",{class:"doc-token"},"index.html",-1),C=(0,t.Uk)("文件的头部(如果你关注过"),I=(0,t.Uk)("Multiminds文章"),q=(0,t.Uk)("，你已经有了这个。) 在你的代码库中创建一个名为"),W=(0,t._)("code",{class:"doc-token"},"analytics.js",-1),E=(0,t.Uk)("的新文件，内容如下："),T=(0,t._)("pre",{class:"doc-code language-javascript"},[(0,t._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-javascript"},[(0,t._)("span",{class:"token keyword"},"export"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"default"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token function"},"logEvent"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("category"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" action"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" label"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" sessionId "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"null")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    window"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("dataLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token literal-property property"},"appEventCategory"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" category"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token literal-property property"},"appEventAction"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" action"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token literal-property property"},"appEventLabel"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" label"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token literal-property property"},"sessionId"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" sessionId\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    window"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("dataLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(),(0,t._)("span",{class:"token string-property property"},"'event'"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'appEvent'"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\n  "),(0,t._)("span",{class:"token function"},"logPage"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" name"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" sessionId "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"null")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    window"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("dataLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token literal-property property"},"screenPath"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token literal-property property"},"screenName"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" name"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token literal-property property"},"sessionId"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" sessionId\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    window"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("dataLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(),(0,t._)("span",{class:"token string-property property"},"'event'"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'appScreenView'"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])],-1),P=(0,t._)("p",null,"为了确保你的应用程序中的所有页面都自动发布到 Google 分析，我们创建了一个应用程序启动文件：",-1),x=(0,t._)("pre",{class:"doc-code language-bash"},[(0,t._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-bash"},[(0,t.Uk)("$ quasar new boot google-analytics "),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("--format ts"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n")])],-1),L=(0,t._)("p",null,[(0,t.Uk)("然后我们编辑新创建的文件。"),(0,t._)("code",{class:"doc-token"},"/src/boot/google-analytics.js"),(0,t.Uk)("。")],-1),D=(0,t._)("pre",{class:"doc-code language-js"},[(0,t._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-js"},[(0,t._)("span",{class:"token keyword"},"import"),(0,t.Uk)(" ga "),(0,t._)("span",{class:"token keyword"},"from"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'analytics.js'"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"export"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"default"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" router "),(0,t._)("span",{class:"token punctuation"},"}")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  router"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"afterEach"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("to"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"from")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    ga"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"logPage"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("to"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" to"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("name"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" sessionId"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])],-1),H=(0,t._)("p",null,[(0,t.Uk)("最后我们在"),(0,t._)("code",{class:"doc-token"},"/quasar.conf.js"),(0,t.Uk)("中注册应用启动文件。如果我们愿意的话，我们可以只对Capacitor包装的应用程序这样做。")],-1),M=(0,t._)("pre",{class:"doc-code language-js"},[(0,t._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-js"},[(0,t._)("span",{class:"token literal-property property"},"boot"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n  ctx"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("mode"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("capacitor "),(0,t._)("span",{class:"token operator"},"?"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'google-analytics'"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"''"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n")])],-1),N=(0,t.Uk)("关于事件的更多信息可以在"),Q=(0,t.Uk)("事件分析文档"),R=(0,t.Uk)(" 中找到。"),S=(0,t._)("p",null,"当你运行你的应用程序时，你会看到事件和页面浏览量的到来。在实时视图中，通常需要5到10秒的时间来注册一个页面浏览。",-1);function V(n,a,s,V,Z,$){const z=(0,t.up)("doc-link"),B=(0,t.up)("doc-page");return(0,t.wg)(),(0,t.j4)(B,{"meta-title":V.metaTitle,title:"管理 Google 分析",nav:V.nav,toc:V.toc,"meta-desc":V.metaDesc},{default:(0,t.w5)((()=>[o,e,(0,t._)("p",null,[c,(0,t.Wm)(z,{to:"https://jannerantala.com/tutorials/quasar-framework-google-tag-manager-and-analytics-setup-for-an-spa-website/"},{default:(0,t.w5)((()=>[p])),_:1})]),l,(0,t._)("h2",{id:"先决条件",class:"doc-heading doc-h2",onClick:a[0]||(a[0]=n=>V.copyHeading("先决条件"))},"先决条件"),(0,t._)("ul",null,[(0,t._)("li",null,[k,u,i,(0,t.Wm)(z,{to:"/quasar-cli/routing"},{default:(0,t.w5)((()=>[r])),_:1}),_])]),(0,t._)("h2",{id:"准备工作",class:"doc-heading doc-h2",onClick:a[1]||(a[1]=n=>V.copyHeading("准备工作"))},"准备工作"),(0,t._)("p",null,[d,(0,t.Wm)(z,{to:"https://analytics.google.com"},{default:(0,t.w5)((()=>[U])),_:1}),g,(0,t.Wm)(z,{to:"https://tagmanager.google.com/"},{default:(0,t.w5)((()=>[y])),_:1}),m,(0,t.Wm)(z,{to:"https://www.multiminds.eu/blog/2016/12/google-analytics-and-tag-manager-with-ionic-and-cordova-apps/"},{default:(0,t.w5)((()=>[w])),_:1}),h]),(0,t._)("h2",{id:"#其落实到应用程序中",class:"doc-heading doc-h2",onClick:a[2]||(a[2]=n=>V.copyHeading("#其落实到应用程序中"))},"#其落实到应用程序中"),(0,t._)("blockquote",f,[(0,t._)("p",null,[v,(0,t.Wm)(z,{to:"https://developers.google.com/analytics/devguides/collection/analyticsjs/cookies-user-id"},{default:(0,t.w5)((()=>[b])),_:1}),G])]),(0,t._)("p",null,[j,A,C,(0,t.Wm)(z,{to:"http://www.multiminds.eu/2016/12/06/google-analytics-tag-manager-ionic-cordova/"},{default:(0,t.w5)((()=>[I])),_:1}),q,W,E]),T,P,x,L,D,H,M,(0,t._)("p",null,[N,(0,t.Wm)(z,{to:"https://developers.google.com/analytics/devguides/collection/analyticsjs/events"},{default:(0,t.w5)((()=>[Q])),_:1}),R]),S])),_:1},8,["meta-title","nav","toc","meta-desc"])}var Z=s(17536);const $={name:"DocMarkdownPage",setup(){return{metaTitle:"管理 Google 分析",metaDesc:"如何在带有 Capacitor 的 Quasar 混合移动应用程序中使用分析。",nav:[{name:"故障排除和提示",category:"开发 Capacitor 应用程序",path:"/quasar-cli/developing-capacitor-apps/troubleshooting-and-tips",dir:"left"},{name:"发布到商店",category:"开发 Capacitor 应用程序",path:"/quasar-cli/developing-capacitor-apps/publishing-to-store",dir:"right"}],toc:[{id:"先决条件",title:"先决条件"},{id:"准备工作",title:"准备工作"},{id:"#其落实到应用程序中",title:"#其落实到应用程序中"}],copyHeading:Z.Et}}};var z=s(74260);const B=(0,z.Z)($,[["render",V]]),F=B}}]);