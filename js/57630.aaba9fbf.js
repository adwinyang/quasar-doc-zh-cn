"use strict";(globalThis["webpackChunkquasar_dev"]=globalThis["webpackChunkquasar_dev"]||[]).push([[57630],{57630:(n,s,a)=>{a.r(s),a.d(s,{default:()=>b});var t=a(83673);const e=(0,t._)("p",null,[(0,t.Uk)("The handling of the 404 & 500 errors on SSR is a bit different than on the other modes (like SPA). If you check out "),(0,t._)("code",{class:"doc-token"},"/src-ssr/middlewares/render.js"),(0,t.Uk)(", you will notice the following section:")],-1),o=(0,t._)("pre",{class:"doc-code language-js"},[(0,t._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-js"},[(0,t._)("span",{class:"token keyword"},"export"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"default"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" app"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" resolve"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" render"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" serve "),(0,t._)("span",{class:"token punctuation"},"}")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token comment"},"// we capture any other Express route and hand it"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token comment"},"// over to Vue and Vue Router to render our page"),(0,t.Uk)("\n  app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"get"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("resolve"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"urlPath"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'*'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Content-Type'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'text/html'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token function"},"render"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"then"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"html"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// now let's send the rendered html to the client"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"send"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("html"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"catch"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"err"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// oops, we had an error while rendering the page"),(0,t.Uk)("\n\n        "),(0,t._)("span",{class:"token comment"},"// we were told to redirect to another URL"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n          "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("code"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"redirect"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("code"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" err"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n          "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n          "),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"redirect"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n          "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// hmm, Vue Router could not find the requested route"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("code "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"404"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n          "),(0,t._)("span",{class:"token comment"},'// Should reach here only if no "catch-all" route'),(0,t.Uk)("\n          "),(0,t._)("span",{class:"token comment"},"// is defined in /src/routes"),(0,t.Uk)("\n          res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"status"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"404"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"send"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'404 | Page Not Found'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// well, we treat any other code as error;"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// if we're in dev mode, then we can use Quasar CLI"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// to display a nice error page that contains the stack"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// and other useful information"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("process"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("env"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token constant"},"DEV"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n          "),(0,t._)("span",{class:"token comment"},"// serve.error is available on dev only"),(0,t.Uk)("\n          serve"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"error"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// we're in production, so we should have another method"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// to display something to the client when we encounter an error"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// (for security reasons, it's not ok to display the same wealth"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// of information as we do in development)"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n          "),(0,t._)("span",{class:"token comment"},"// Render Error Page on production or"),(0,t.Uk)("\n          "),(0,t._)("span",{class:"token comment"},"// create a route (/src/routes) for an error page and redirect to it"),(0,t.Uk)("\n          res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"status"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"500"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"send"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'500 | Internal Server Error'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])],-1),c=(0,t._)("p",null,"The section above is written after catching the other possible requests (like for /public folder, the manifest.json and service worker, etc). This is where we render the page with Vue and Vue Router.",-1),p=(0,t._)("p",null,"We’ll discuss some architectural decisions that you need to be aware of. Choose whatever fits your app best.",-1),r=(0,t._)("p",null,[(0,t.Uk)("If you define an equivalent 404 route on your Vue Router "),(0,t._)("code",{class:"doc-token"},"/src/router/routes.js"),(0,t.Uk)(" file (like below), then "),(0,t._)("code",{class:"doc-token"},"if (err.code === 404) {"),(0,t.Uk)(" part from the example above will NEVER be "),(0,t._)("code",{class:"doc-token"},"true"),(0,t.Uk)(" since Vue Router already handled it.")],-1),k=(0,t._)("pre",{class:"doc-code language-js"},[(0,t._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-js"},[(0,t._)("span",{class:"token comment"},"// Example of route for catching 404 with Vue Router"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(),(0,t._)("span",{class:"token literal-property property"},"path"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'/:catchAll(.*)*'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token function-variable function"},"component"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"import"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'pages/Error404.vue'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])],-1),u=(0,t._)("p",null,[(0,t.Uk)("On the "),(0,t._)("code",{class:"doc-token"},"/src-ssr/middlewares/render.js"),(0,t.Uk)(" example at the top of the page, notice that if the webserver encounters any rendering error, we send a simple string back to the client (‘500 | Internal Server Error’). If you want to show a nice page instead, you could:")],-1),l=(0,t._)("ol",null,[(0,t._)("li",null,[(0,t.Uk)("Add a specific route in "),(0,t._)("code",{class:"doc-token"},"/src/router/routes.js"),(0,t.Uk)(", like:")])],-1),i=(0,t._)("pre",{class:"doc-code language-js"},[(0,t._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-js"},[(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(),(0,t._)("span",{class:"token literal-property property"},"path"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'error500'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token function-variable function"},"component"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"import"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'pages/Error500.vue'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])],-1),_=(0,t._)("ol",{start:"2"},[(0,t._)("li",null,[(0,t.Uk)("Write the Vue component to handle this page. In this example, we create "),(0,t._)("code",{class:"doc-token"},"/src/pages/Error500.vue")]),(0,t._)("li",null,[(0,t.Uk)("Then in "),(0,t._)("code",{class:"doc-token"},"/src-ssr/middlewares/render.js"),(0,t.Uk)(":")])],-1),d=(0,t._)("pre",{class:"doc-code language-js"},[(0,t._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-js"},[(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("code "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"404"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token comment"},"// We got a 500 error here;"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token comment"},'// We redirect to our "error500" route newly defined at step #1.'),(0,t.Uk)("\n  res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"redirect"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("resolve"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"urlPath"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'error500'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"// keep account of publicPath though!"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])],-1),U=(0,t._)("div",{class:"doc-note doc-note--danger"},[(0,t._)("p",{class:"doc-note__title"},"WARNING"),(0,t._)("p",null,"The only caveat is that you need to be sure that while rendering ‘/error500’ route you don’t get another 500 error, which would put your app into an infinite loop!")],-1),h=(0,t._)("p",null,[(0,t.Uk)("A perfect approach to avoid this would simply be to directly return the HTML (as String) of the error 500 page from "),(0,t._)("code",{class:"doc-token"},"/src-ssr/middlewares/render.js"),(0,t.Uk)(":")],-1),m=(0,t._)("pre",{class:"doc-code language-js"},[(0,t._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-js"},[(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"status"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"500"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"send"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token template-string"},[(0,t._)("span",{class:"token template-punctuation string"},"`"),(0,t._)("span",{class:"token string"},"<html>....</html>"),(0,t._)("span",{class:"token template-punctuation string"},"`")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])],-1);function g(n,s,a,g,f,w){const y=(0,t.up)("doc-page");return(0,t.wg)(),(0,t.j4)(y,{"meta-title":g.metaTitle,title:"SSR Handling of 404 and 500 Errors","meta-desc":g.metaDesc},{default:(0,t.w5)((()=>[e,o,c,(0,t._)("h2",{id:"things-to-be-aware-of",class:"doc-heading doc-h2",onClick:s[0]||(s[0]=n=>g.copyHeading("things-to-be-aware-of"))},"Things to be aware of"),p,(0,t._)("h3",{id:"error-404",class:"doc-heading doc-h3",onClick:s[1]||(s[1]=n=>g.copyHeading("error-404"))},"Error 404"),r,k,(0,t._)("h3",{id:"error-500",class:"doc-heading doc-h3",onClick:s[2]||(s[2]=n=>g.copyHeading("error-500"))},"Error 500"),u,l,i,_,d,U,h,m])),_:1},8,["meta-title","meta-desc"])}var f=a(17536);const w={name:"DocMarkdownPage",setup(){return{metaTitle:"SSR Handling of 404 and 500 Errors",metaDesc:"Managing the common 404 and 500 HTTP errors in a Quasar server-side rendered app.",copyHeading:f.Et}}};var y=a(74260);const v=(0,y.Z)(w,[["render",g]]),b=v}}]);