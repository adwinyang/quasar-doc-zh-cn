"use strict";(globalThis["webpackChunkquasar_dev"]=globalThis["webpackChunkquasar_dev"]||[]).push([[31911],{31911:(n,s,a)=>{a.r(s),a.d(s,{default:()=>B});var t=a(83673);const o=(0,t._)("code",{class:"doc-token"},"src-bex/js/background-hooks.js",-1),e=(0,t.Uk)(" 本质上是一个标准的"),c=(0,t.Uk)("后台脚本"),p=(0,t.Uk)("，欢迎你使用它。后台脚本可以与在您的 BEX 下运行的 "),k=(0,t._)("strong",null,"所有",-1),u=(0,t.Uk)(" 网页、开发工具、选项和弹出窗口进行通信。"),l=(0,t._)("p",null,"此文件的额外好处是此功能：",-1),_=(0,t._)("pre",{class:"doc-code language-js"},[(0,t._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-js"},[(0,t._)("span",{class:"token keyword"},"export"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"default"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"attachBackgroundHooks"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("bridge"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" activeConnections")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])],-1),i=(0,t._)("p",null,"这个函数通过 Quasar BEX 构建链自动调用，并注入一个BEX所有部分之间共享的桥，这意味着你可以与BEX的任何部分进行通信。",-1),r=(0,t._)("p",null,[(0,t._)("code",{class:"doc-token"},"bridge"),(0,t.Uk)(" 参数是用于通信的桥接器。 "),(0,t._)("code",{class:"doc-token"},"activeConnections"),(0,t.Uk)(" 参数提供了通过桥接器注册的所有 BEX 连接的数组，即同一个 Quasar 应用程序使用的所有网页、选项、弹出窗口和开发工具 BEX。")],-1),d=(0,t._)("p",null,"例如，假设我们想监听在网页浏览器中打开的新标签，然后在我们的 Quasar 应用程序中对其作出反应。首先，我们需要监听新的标签页被打开，并发出一个新的事件来告诉 Quasar 应用程序这已经发生。",-1),U=(0,t._)("pre",{class:"doc-code language-js"},[(0,t._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-js"},[(0,t.Uk)("chrome"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("tabs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("onUpdated"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"addListener"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("tabId"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" changeInfo"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" tab")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  bridge"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"send"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'bex.tab.opened'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(),(0,t._)("span",{class:"token literal-property property"},"url"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" tab"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])],-1),g=(0,t._)("p",null,"然后在我们的 Quasar 应用程序中，我们会在我们的一个组件生命周期钩子中监听这个，像这样：",-1),m=(0,t._)("pre",{class:"doc-code language-js"},[(0,t._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-js"},[(0,t._)("span",{class:"token keyword"},"import"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" useQuasar "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"from"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'quasar'"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"import"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" onBeforeUnmount "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"from"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'vue'"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"export"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"default"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token function"},"setup"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" $q "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"useQuasar"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token comment"},"// 我们的函数，接收后台脚本发送的URL。"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"doOnTabOpened"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"url"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'New Browser Tab Openend: '"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" url"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token comment"},"// 添加我们的听众"),(0,t.Uk)("\n    $q"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("bex"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'bex.tab.opened'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" doOnTabOpened"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token comment"},"// 不要忘了清理它"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"onBeforeUnmount"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      $q"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("bex"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"off"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'bex.tab.opened'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" doOnTabOpened"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])],-1),b=(0,t._)("p",null,"浏览器扩展后台脚本可做各种各样的事件–如果你想在这方面有所作为，请善于利用搜索引擎。",-1),f=(0,t._)("p",null,[(0,t.Uk)("如果你想以某种方式修改底层的网页内容呢？这就是我们要使用"),(0,t._)("code",{class:"doc-token"},"content-hooks.js"),(0,t.Uk)("的地方。让我们在下一节看一下。")],-1);function w(n,s,a,w,y,h){const v=(0,t.up)("doc-link"),x=(0,t.up)("doc-page");return(0,t.wg)(),(0,t.j4)(x,{"meta-title":w.metaTitle,title:"背景钩子",nav:w.nav,toc:w.toc,"meta-desc":w.metaDesc},{default:(0,t.w5)((()=>[(0,t._)("p",null,[o,e,(0,t.Wm)(v,{to:"https://developer.chrome.com/extensions/background_pages"},{default:(0,t.w5)((()=>[c])),_:1}),p,k,u]),l,_,i,r,d,U,g,m,b,f])),_:1},8,["meta-title","nav","toc","meta-desc"])}var y=a(17536);const h={name:"DocMarkdownPage",setup(){return{metaTitle:"背景钩子",metaDesc:"如何使用后台脚本与浏览器扩展（BEX）的其他部分进行通信。",nav:[{name:"BEX交流/活动",category:"开发浏览器扩展",path:"/quasar-cli/developing-browser-extensions/bex-communication",dir:"left"},{name:"内容钩子",category:"开发浏览器扩展",path:"/quasar-cli/developing-browser-extensions/content-hooks",dir:"right"}],toc:[],copyHeading:y.Et}}};var v=a(74260);const x=(0,v.Z)(h,[["render",w]]),B=x}}]);