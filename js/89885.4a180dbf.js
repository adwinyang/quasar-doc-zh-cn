"use strict";(globalThis["webpackChunkquasar_dev"]=globalThis["webpackChunkquasar_dev"]||[]).push([[89885],{89885:(n,a,s)=>{s.r(a),s.d(a,{default:()=>K});var o=s(83673);const t=(0,o._)("p",null,"了解你的用户和测量用户行为是App开发中的一个重要步骤。不幸的是，在用 Cordova 包装你的移动应用程序后，要让Google Analytics发挥作用，需要做一些非标准的工作。在纯网络应用中设置Google Analytics是很容易的，但 Cordova 不知为何会阻止页面浏览和事件被发送到Google Analytics。",-1),e=(0,o._)("p",null,"按照这个指南，在你的由 Cordova 驱动的Quasar App中实施Google Analytics。",-1),c=(0,o._)("p",null,"你可能还想阅读这些伟大的教程。",-1),p=(0,o.Uk)("SPA网站的 Google 标签管理器和分析设置"),l=(0,o.Uk)("Google 分析设置为一个 Cordova 应用程序"),k=(0,o._)("div",{class:"doc-note doc-note--warning"},[(0,o._)("p",{class:"doc-note__title"},"WARNING"),(0,o._)("p",null,[(0,o.Uk)("你需要在"),(0,o._)("code",{class:"doc-token"},"/src/index.template.html"),(0,o.Uk)("中加入 Google 提供的"),(0,o._)("code",{class:"doc-token"},"<script>"),(0,o.Uk)('标签，这将使你的应用程序依赖于互联网连接！"。')])],-1),u=(0,o.Uk)("确保你所有的路由都有一个指定的名称和路径参数。否则，它们不能被发布到"),i=(0,o._)("code",{class:"doc-token"},"ga.logPage",-1),r=(0,o.Uk)("函数中。请参考"),_=(0,o.Uk)("Routing"),d=(0,o.Uk)(" 了解更多关于路由的信息。"),g=(0,o._)("li",null,"具备 Google 分析的基本知识",-1),U=(0,o.Uk)("在我们开始在你的应用程序中实施 Google Analytics之前，你需要一个"),y=(0,o.Uk)("Google Analytics"),m=(0,o.Uk)("和"),w=(0,o.Uk)("Google Tagmanager"),h=(0,o.Uk)(" 的账户。所以让我们先做这个。当你有了这些账户，是时候配置Tag manager了。按照这个"),v=(0,o.Uk)("多元思维文章"),f=(0,o.Uk)(" 中的步骤来做。"),b={class:"doc-note"},G=(0,o.Uk)("在本指南中，我们将假设你有一个固定 的sessionId，并将其发送给Google Analytics。Google Analytics 使用 sessionId 来区分不同的用户。如果你想创建一个匿名的 sessionId，请参阅"),j=(0,o.Uk)("Analytics Documentation on user id"),A=(0,o.Uk)(" 。"),C=(0,o.Uk)("将 Tag Manager 片段放到你的"),I=(0,o._)("code",{class:"doc-token"},"index.html",-1),q=(0,o.Uk)("文件的头部(如果你关注过"),W=(0,o.Uk)("多元思维文章"),E=(0,o.Uk)(" ，你已经有了这个。) 在你的代码库中创建一个名为 "),T=(0,o._)("code",{class:"doc-token"},"analytics.js",-1),P=(0,o.Uk)(" 的新文件，内容如下。"),x=(0,o._)("pre",{class:"doc-code language-javascript"},[(0,o._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-javascript"},[(0,o._)("span",{class:"token keyword"},"export"),(0,o.Uk)(),(0,o._)("span",{class:"token keyword"},"default"),(0,o.Uk)(),(0,o._)("span",{class:"token punctuation"},"{"),(0,o.Uk)("\n  "),(0,o._)("span",{class:"token function"},"logEvent"),(0,o._)("span",{class:"token punctuation"},"("),(0,o._)("span",{class:"token parameter"},[(0,o.Uk)("category"),(0,o._)("span",{class:"token punctuation"},","),(0,o.Uk)(" action"),(0,o._)("span",{class:"token punctuation"},","),(0,o.Uk)(" label"),(0,o._)("span",{class:"token punctuation"},","),(0,o.Uk)(" sessionId "),(0,o._)("span",{class:"token operator"},"="),(0,o.Uk)(),(0,o._)("span",{class:"token keyword"},"null")]),(0,o._)("span",{class:"token punctuation"},")"),(0,o.Uk)(),(0,o._)("span",{class:"token punctuation"},"{"),(0,o.Uk)("\n    window"),(0,o._)("span",{class:"token punctuation"},"."),(0,o.Uk)("dataLayer"),(0,o._)("span",{class:"token punctuation"},"."),(0,o._)("span",{class:"token function"},"push"),(0,o._)("span",{class:"token punctuation"},"("),(0,o._)("span",{class:"token punctuation"},"{"),(0,o.Uk)("\n      "),(0,o._)("span",{class:"token literal-property property"},"appEventCategory"),(0,o._)("span",{class:"token operator"},":"),(0,o.Uk)(" category"),(0,o._)("span",{class:"token punctuation"},","),(0,o.Uk)("\n      "),(0,o._)("span",{class:"token literal-property property"},"appEventAction"),(0,o._)("span",{class:"token operator"},":"),(0,o.Uk)(" action"),(0,o._)("span",{class:"token punctuation"},","),(0,o.Uk)("\n      "),(0,o._)("span",{class:"token literal-property property"},"appEventLabel"),(0,o._)("span",{class:"token operator"},":"),(0,o.Uk)(" label"),(0,o._)("span",{class:"token punctuation"},","),(0,o.Uk)("\n      "),(0,o._)("span",{class:"token literal-property property"},"sessionId"),(0,o._)("span",{class:"token operator"},":"),(0,o.Uk)(" sessionId\n    "),(0,o._)("span",{class:"token punctuation"},"}"),(0,o._)("span",{class:"token punctuation"},")"),(0,o.Uk)("\n    window"),(0,o._)("span",{class:"token punctuation"},"."),(0,o.Uk)("dataLayer"),(0,o._)("span",{class:"token punctuation"},"."),(0,o._)("span",{class:"token function"},"push"),(0,o._)("span",{class:"token punctuation"},"("),(0,o._)("span",{class:"token punctuation"},"{"),(0,o.Uk)(),(0,o._)("span",{class:"token string-property property"},"'event'"),(0,o._)("span",{class:"token operator"},":"),(0,o.Uk)(),(0,o._)("span",{class:"token string"},"'appEvent'"),(0,o.Uk)(),(0,o._)("span",{class:"token punctuation"},"}"),(0,o._)("span",{class:"token punctuation"},")"),(0,o.Uk)("\n  "),(0,o._)("span",{class:"token punctuation"},"}"),(0,o._)("span",{class:"token punctuation"},","),(0,o.Uk)("\n\n  "),(0,o._)("span",{class:"token function"},"logPage"),(0,o._)("span",{class:"token punctuation"},"("),(0,o._)("span",{class:"token parameter"},[(0,o.Uk)("path"),(0,o._)("span",{class:"token punctuation"},","),(0,o.Uk)(" name"),(0,o._)("span",{class:"token punctuation"},","),(0,o.Uk)(" sessionId "),(0,o._)("span",{class:"token operator"},"="),(0,o.Uk)(),(0,o._)("span",{class:"token keyword"},"null")]),(0,o._)("span",{class:"token punctuation"},")"),(0,o.Uk)(),(0,o._)("span",{class:"token punctuation"},"{"),(0,o.Uk)("\n    window"),(0,o._)("span",{class:"token punctuation"},"."),(0,o.Uk)("dataLayer"),(0,o._)("span",{class:"token punctuation"},"."),(0,o._)("span",{class:"token function"},"push"),(0,o._)("span",{class:"token punctuation"},"("),(0,o._)("span",{class:"token punctuation"},"{"),(0,o.Uk)("\n      "),(0,o._)("span",{class:"token literal-property property"},"screenPath"),(0,o._)("span",{class:"token operator"},":"),(0,o.Uk)(" path"),(0,o._)("span",{class:"token punctuation"},","),(0,o.Uk)("\n      "),(0,o._)("span",{class:"token literal-property property"},"screenName"),(0,o._)("span",{class:"token operator"},":"),(0,o.Uk)(" name"),(0,o._)("span",{class:"token punctuation"},","),(0,o.Uk)("\n      "),(0,o._)("span",{class:"token literal-property property"},"sessionId"),(0,o._)("span",{class:"token operator"},":"),(0,o.Uk)(" sessionId\n    "),(0,o._)("span",{class:"token punctuation"},"}"),(0,o._)("span",{class:"token punctuation"},")"),(0,o.Uk)("\n    window"),(0,o._)("span",{class:"token punctuation"},"."),(0,o.Uk)("dataLayer"),(0,o._)("span",{class:"token punctuation"},"."),(0,o._)("span",{class:"token function"},"push"),(0,o._)("span",{class:"token punctuation"},"("),(0,o._)("span",{class:"token punctuation"},"{"),(0,o.Uk)(),(0,o._)("span",{class:"token string-property property"},"'event'"),(0,o._)("span",{class:"token operator"},":"),(0,o.Uk)(),(0,o._)("span",{class:"token string"},"'appScreenView'"),(0,o.Uk)(),(0,o._)("span",{class:"token punctuation"},"}"),(0,o._)("span",{class:"token punctuation"},")"),(0,o.Uk)("\n  "),(0,o._)("span",{class:"token punctuation"},"}"),(0,o.Uk)("\n"),(0,o._)("span",{class:"token punctuation"},"}"),(0,o.Uk)("\n")])],-1),L=(0,o._)("p",null,"为了确保你的应用程序中的所有页面都自动发布到 Google 分析，我们创建了一个应用程序启动文件:",-1),D=(0,o._)("pre",{class:"doc-code language-bash"},[(0,o._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-bash"},[(0,o.Uk)("$ quasar new boot google-analytics "),(0,o._)("span",{class:"token punctuation"},"["),(0,o.Uk)("--format ts"),(0,o._)("span",{class:"token punctuation"},"]"),(0,o.Uk)("\n")])],-1),H=(0,o._)("p",null,[(0,o.Uk)("然后我们编辑新创建的文件。"),(0,o._)("code",{class:"doc-token"},"/src/boot/google-analytics.js"),(0,o.Uk)("：")],-1),N=(0,o._)("pre",{class:"doc-code language-js"},[(0,o._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-js"},[(0,o._)("span",{class:"token keyword"},"import"),(0,o.Uk)(" ga "),(0,o._)("span",{class:"token keyword"},"from"),(0,o.Uk)(),(0,o._)("span",{class:"token string"},"'analytics.js'"),(0,o.Uk)("\n\n"),(0,o._)("span",{class:"token keyword"},"export"),(0,o.Uk)(),(0,o._)("span",{class:"token keyword"},"default"),(0,o.Uk)(),(0,o._)("span",{class:"token punctuation"},"("),(0,o._)("span",{class:"token parameter"},[(0,o._)("span",{class:"token punctuation"},"{"),(0,o.Uk)(" router "),(0,o._)("span",{class:"token punctuation"},"}")]),(0,o._)("span",{class:"token punctuation"},")"),(0,o.Uk)(),(0,o._)("span",{class:"token operator"},"=>"),(0,o.Uk)(),(0,o._)("span",{class:"token punctuation"},"{"),(0,o.Uk)("\n  router"),(0,o._)("span",{class:"token punctuation"},"."),(0,o._)("span",{class:"token function"},"afterEach"),(0,o._)("span",{class:"token punctuation"},"("),(0,o._)("span",{class:"token punctuation"},"("),(0,o._)("span",{class:"token parameter"},[(0,o.Uk)("to"),(0,o._)("span",{class:"token punctuation"},","),(0,o.Uk)(),(0,o._)("span",{class:"token keyword"},"from")]),(0,o._)("span",{class:"token punctuation"},")"),(0,o.Uk)(),(0,o._)("span",{class:"token operator"},"=>"),(0,o.Uk)(),(0,o._)("span",{class:"token punctuation"},"{"),(0,o.Uk)("\n    ga"),(0,o._)("span",{class:"token punctuation"},"."),(0,o._)("span",{class:"token function"},"logPage"),(0,o._)("span",{class:"token punctuation"},"("),(0,o.Uk)("to"),(0,o._)("span",{class:"token punctuation"},"."),(0,o.Uk)("path"),(0,o._)("span",{class:"token punctuation"},","),(0,o.Uk)(" to"),(0,o._)("span",{class:"token punctuation"},"."),(0,o.Uk)("name"),(0,o._)("span",{class:"token punctuation"},","),(0,o.Uk)(" sessionId"),(0,o._)("span",{class:"token punctuation"},")"),(0,o.Uk)("\n  "),(0,o._)("span",{class:"token punctuation"},"}"),(0,o._)("span",{class:"token punctuation"},")"),(0,o.Uk)("\n"),(0,o._)("span",{class:"token punctuation"},"}"),(0,o.Uk)("\n")])],-1),M=(0,o._)("p",null,[(0,o.Uk)("最后我们在"),(0,o._)("code",{class:"doc-token"},"/quasar.conf.js"),(0,o.Uk)("中注册应用启动文件。如果我们愿意的话，我们可以只对 Cordova 包装的应用程序这样做：")],-1),Q=(0,o._)("pre",{class:"doc-code language-js"},[(0,o._)("code",{class:"doc-code__inner doc-code__inner--prerendered language-js"},[(0,o._)("span",{class:"token literal-property property"},"boot"),(0,o._)("span",{class:"token operator"},":"),(0,o.Uk)(),(0,o._)("span",{class:"token punctuation"},"["),(0,o.Uk)("\n  ctx"),(0,o._)("span",{class:"token punctuation"},"."),(0,o.Uk)("mode"),(0,o._)("span",{class:"token punctuation"},"."),(0,o.Uk)("cordova "),(0,o._)("span",{class:"token operator"},"?"),(0,o.Uk)(),(0,o._)("span",{class:"token string"},"'google-analytics'"),(0,o.Uk)(),(0,o._)("span",{class:"token operator"},":"),(0,o.Uk)(),(0,o._)("span",{class:"token string"},"''"),(0,o.Uk)("\n"),(0,o._)("span",{class:"token punctuation"},"]"),(0,o.Uk)("\n")])],-1),R=(0,o.Uk)("关于事件的更多信息可以在"),S=(0,o.Uk)("Analytics documentation on events"),V=(0,o.Uk)(" 中找到。"),Z=(0,o._)("p",null,"当你运行你的应用程序时，你会看到事件和页面浏览量的到来。在实时视图中，通常需要5到10秒的时间来注册一个页面浏览。",-1);function $(n,a,s,$,z,B){const F=(0,o.up)("doc-link"),J=(0,o.up)("doc-page");return(0,o.wg)(),(0,o.j4)(J,{"meta-title":$.metaTitle,title:"管理 Google 分析",nav:$.nav,toc:$.toc,"meta-desc":$.metaDesc},{default:(0,o.w5)((()=>[t,e,c,(0,o._)("ul",null,[(0,o._)("li",null,[(0,o.Wm)(F,{to:"https://jannerantala.com/tutorials/quasar-framework-google-tag-manager-and-analytics-setup-for-an-spa-website/"},{default:(0,o.w5)((()=>[p])),_:1})]),(0,o._)("li",null,[(0,o.Wm)(F,{to:"https://jannerantala.com/tutorials/quasar-framework-google-analytics-setup-for-cordova-app/"},{default:(0,o.w5)((()=>[l])),_:1})])]),k,(0,o._)("h2",{id:"先决条件",class:"doc-heading doc-h2",onClick:a[0]||(a[0]=n=>$.copyHeading("先决条件"))},"先决条件"),(0,o._)("ul",null,[(0,o._)("li",null,[u,i,r,(0,o.Wm)(F,{to:"/quasar-cli/routing"},{default:(0,o.w5)((()=>[_])),_:1}),d]),g]),(0,o._)("h2",{id:"准备工作",class:"doc-heading doc-h2",onClick:a[1]||(a[1]=n=>$.copyHeading("准备工作"))},"准备工作"),(0,o._)("p",null,[U,(0,o.Wm)(F,{to:"https://analytics.google.com"},{default:(0,o.w5)((()=>[y])),_:1}),m,(0,o.Wm)(F,{to:"https://tagmanager.google.com/"},{default:(0,o.w5)((()=>[w])),_:1}),h,(0,o.Wm)(F,{to:"https://www.multiminds.eu/blog/2016/12/google-analytics-and-tag-manager-with-ionic-and-cordova-apps/"},{default:(0,o.w5)((()=>[v])),_:1}),f]),(0,o._)("h2",{id:"将其落实到应用程序中",class:"doc-heading doc-h2",onClick:a[2]||(a[2]=n=>$.copyHeading("将其落实到应用程序中"))},"将其落实到应用程序中"),(0,o._)("blockquote",b,[(0,o._)("p",null,[G,(0,o.Wm)(F,{to:"https://developers.google.com/analytics/devguides/collection/analyticsjs/cookies-user-id"},{default:(0,o.w5)((()=>[j])),_:1}),A])]),(0,o._)("p",null,[C,I,q,(0,o.Wm)(F,{to:"http://www.multiminds.eu/2016/12/06/google-analytics-tag-manager-ionic-cordova/"},{default:(0,o.w5)((()=>[W])),_:1}),E,T,P]),x,L,D,H,N,M,Q,(0,o._)("p",null,[R,(0,o.Wm)(F,{to:"https://developers.google.com/analytics/devguides/collection/analyticsjs/events"},{default:(0,o.w5)((()=>[S])),_:1}),V]),Z])),_:1},8,["meta-title","nav","toc","meta-desc"])}var z=s(17536);const B={name:"DocMarkdownPage",setup(){return{metaTitle:"管理 Google 分析",metaDesc:"如何在使用 Cordova 的 Quasar 混合移动应用中使用分析技术。",nav:[{name:"故障排除和提示",category:"开发 Cordova 应用程序",path:"/quasar-cli/developing-cordova-apps/troubleshooting-and-tips",dir:"left"},{name:"发布到商店",category:"开发 Cordova 应用程序",path:"/quasar-cli/developing-cordova-apps/publishing-to-store",dir:"right"}],toc:[{id:"先决条件",title:"先决条件"},{id:"准备工作",title:"准备工作"},{id:"将其落实到应用程序中",title:"将其落实到应用程序中"}],copyHeading:z.Et}}};var F=s(74260);const J=(0,F.Z)(B,[["render",$]]),K=J}}]);